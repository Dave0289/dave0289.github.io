<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Common Scents</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
  html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: #000;
    overflow: hidden;
    font-family: "Times New Roman", serif;
    color: #f2f2f2;
  }

  .stage {
    position: relative;
    width: 100%;
    height: 100%;
  }

  /* TEXT (kept, not competing with flames) */
  .text {
    position: absolute;
    top: 18%;
    width: 100%;
    text-align: center;
    z-index: 10;
    letter-spacing: 4px;
    pointer-events: none;
    text-shadow: 0 2px 22px rgba(0,0,0,0.9);
  }

  .text h1 {
    margin: 0;
    font-size: clamp(2.4rem, 6vw, 3.2rem);
    font-weight: 500;
  }

  .text p {
    margin-top: 18px;
    font-size: clamp(0.9rem, 3vw, 1.05rem);
    opacity: 0.85;
    letter-spacing: 3px;
  }

  /* FIRE CANVAS AREA */
  #fire {
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    height: min(42vh, 420px);
    z-index: 2;
  }

  /* Soft warm wash above the flames (subtle) */
  .heat-wash {
    position: absolute;
    left: 0;
    bottom: 0;
    width: 100%;
    height: min(55vh, 560px);
    z-index: 3;
    pointer-events: none;
    background:
      radial-gradient(ellipse at 50% 100%,
        rgba(255,170,70,0.10) 0%,
        rgba(255,120,20,0.06) 25%,
        rgba(255,80,10,0.03) 45%,
        rgba(0,0,0,0.0) 70%);
    filter: blur(0.5px);
    opacity: 0.95;
  }

  /* Fade to black so the top stays clean */
  .top-fade {
    position: absolute;
    inset: 0;
    z-index: 6;
    pointer-events: none;
    background:
      linear-gradient(to top,
        rgba(0,0,0,0.00) 0%,
        rgba(0,0,0,0.25) 35%,
        rgba(0,0,0,0.65) 70%,
        rgba(0,0,0,0.90) 100%);
  }

  /* Slight “firebox” dark band right above flame bed */
  .firebox-shadow {
    position: absolute;
    left: 0;
    bottom: calc(min(42vh, 420px) - 40px);
    width: 100%;
    height: 90px;
    z-index: 4;
    pointer-events: none;
    background:
      radial-gradient(ellipse at 50% 120%,
        rgba(0,0,0,0.55) 0%,
        rgba(0,0,0,0.35) 35%,
        rgba(0,0,0,0.15) 60%,
        rgba(0,0,0,0.00) 80%);
  }

  @media (max-width: 768px) {
    #fire { height: min(38vh, 360px); }
    .heat-wash { height: min(50vh, 520px); }
    .firebox-shadow { bottom: calc(min(38vh, 360px) - 38px); }
  }
</style>
</head>

<body>
  <div class="stage">
    <div class="text">
      <h1>COMMON SCENTS</h1>
      <p>Coming Soon · 2026</p>
    </div>

    <canvas id="fire"></canvas>
    <div class="heat-wash"></div>
    <div class="firebox-shadow"></div>
    <div class="top-fade"></div>
  </div>

<script>
(() => {
  const canvas = document.getElementById("fire");
  const ctx = canvas.getContext("2d", { alpha: true });

  // Respect reduced motion
  const reduceMotion = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

  // DPR-aware sizing
  function resize() {
    const rect = canvas.getBoundingClientRect();
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    canvas.width  = Math.floor(rect.width  * dpr);
    canvas.height = Math.floor(rect.height * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0); // draw in CSS pixels
  }
  window.addEventListener("resize", resize, { passive: true });
  resize();

  // --- Simple 2D value noise (fast enough, looks organic) ---
  function hash(n) {
    n = (n << 13) ^ n;
    return (1.0 - ((n * (n * n * 15731 + 789221) + 1376312589) & 0x7fffffff) / 1073741824.0);
  }
  function lerp(a,b,t){ return a + (b-a)*t; }
  function smoothstep(t){ return t*t*(3-2*t); }
  function noise2D(x, y) {
    const xi = Math.floor(x);
    const yi = Math.floor(y);
    const xf = x - xi;
    const yf = y - yi;

    const s = hash(xi + yi * 57);
    const t = hash((xi + 1) + yi * 57);
    const u = hash(xi + (yi + 1) * 57);
    const v = hash((xi + 1) + (yi + 1) * 57);

    const sx = smoothstep(xf);
    const sy = smoothstep(yf);

    const a = lerp(s, t, sx);
    const b = lerp(u, v, sx);
    return lerp(a, b, sy); // -1..1-ish
  }

  // --- Particle flame system ---
  const P = [];
  let t = 0;

  function spawn(count) {
    const w = canvas.clientWidth;
    const h = canvas.clientHeight;
    const baseY = h - 8;

    for (let i = 0; i < count; i++) {
      // Clustered spawns look more like a fireplace "bed"
      const x = (Math.random() * w);
      const cluster = noise2D(x * 0.03, t * 0.002) * 0.5 + 0.5;
      const intensity = 0.35 + cluster * 0.9;

      P.push({
        x,
        y: baseY + (Math.random() * 10),
        vx: (Math.random() - 0.5) * 0.6,
        vy: -(1.4 + Math.random() * 2.8) * intensity,
        life: 0,
        ttl: 45 + Math.random() * 65,
        size: 10 + Math.random() * 26 * intensity,
        heat: intensity
      });
    }
  }

  function drawEmbers() {
    const w = canvas.clientWidth;
    const h = canvas.clientHeight;
    const y = h - 10;

    // ember bed glow
    const g = ctx.createLinearGradient(0, y - 55, 0, y + 20);
    g.addColorStop(0.00, "rgba(0,0,0,0.00)");
    g.addColorStop(0.35, "rgba(255,120,20,0.10)");
    g.addColorStop(0.70, "rgba(255,90,10,0.22)");
    g.addColorStop(1.00, "rgba(255,160,60,0.22)");
    ctx.fillStyle = g;
    ctx.fillRect(0, y - 70, w, 90);

    // scattered hot coals
    for (let i = 0; i < 110; i++) {
      const x = Math.random() * w;
      const r = 0.7 + Math.random() * 2.1;
      const a = 0.06 + Math.random() * 0.16;
      ctx.beginPath();
      ctx.fillStyle = `rgba(255,180,90,${a})`;
      ctx.arc(x, y + (Math.random() * 8), r, 0, Math.PI * 2);
      ctx.fill();
    }
  }

  function flameColor(age01, heat) {
    // age01: 0 at birth -> 1 at death
    // Brighter/whiter near base, orange mid, darker red near top/fade
    const baseBoost = (1 - age01);
    const a = Math.max(0, 0.42 * (1 - age01));
    const hot = Math.min(1, 0.6 * heat + 0.4 * baseBoost);

    // Mix “core” and “shell”
    // Core (white/yellow)
    const r1 = 255;
    const g1 = Math.floor(220 + 25 * hot);
    const b1 = Math.floor(140 + 20 * hot);

    // Shell (orange/red)
    const r2 = 255;
    const g2 = Math.floor(120 + 80 * (1 - age01));
    const b2 = Math.floor(30 + 40 * (1 - age01));

    const mix = Math.max(0, Math.min(1, 0.55 * hot + 0.25));
    const r = Math.floor(lerp(r2, r1, mix));
    const g = Math.floor(lerp(g2, g1, mix));
    const b = Math.floor(lerp(b2, b1, mix));

    return `rgba(${r},${g},${b},${a})`;
  }

  function step() {
    const w = canvas.clientWidth;
    const h = canvas.clientHeight;

    // Clear with a little “trail” for smooth flame motion
    ctx.globalCompositeOperation = "source-over";
    ctx.fillStyle = "rgba(0,0,0,0.18)";
    ctx.fillRect(0, 0, w, h);

    // Additive blending makes it look like light
    ctx.globalCompositeOperation = "lighter";

    // Embers/base glow
    drawEmbers();

    // Spawn rate tuned for realism + performance
    if (!reduceMotion) spawn(18);
    else spawn(6);

    // Update/draw particles
    for (let i = P.length - 1; i >= 0; i--) {
      const p = P[i];
      p.life++;

      const age01 = p.life / p.ttl;

      // Turbulence: horizontal sway increases with height
      const n = noise2D(p.x * 0.015, (t + p.y) * 0.01);
      const sway = n * (0.9 + age01 * 2.4);

      p.vx += sway * 0.04;
      p.vx *= 0.985;
      p.x += p.vx;

      // Rising slows near the top; flutter with noise
      const liftNoise = noise2D(p.x * 0.02, (t * 0.02) + i * 0.01);
      p.y += p.vy * (0.92 + 0.22 * liftNoise);

      // Keep within bounds
      if (p.x < -40) p.x = w + 40;
      if (p.x > w + 40) p.x = -40;

      // Size shrinks as it rises; blur grows a bit
      const size = Math.max(1, p.size * (1.05 - age01));
      const blur = 6 + 20 * age01;

      ctx.save();
      ctx.filter = `blur(${blur}px)`;
      ctx.fillStyle = flameColor(age01, p.heat);

      // Draw as soft “tongue” oval (more fireplace-like than circles)
      ctx.beginPath();
      const rx = size * (0.40 + 0.35 * (1 - age01));
      const ry = size * (0.95 + 0.55 * (1 - age01));
      ctx.ellipse(p.x, p.y, rx, ry, 0, 0, Math.PI * 2);
      ctx.fill();
      ctx.restore();

      // Kill old particles
      if (p.life >= p.ttl || p.y < -120) P.splice(i, 1);
    }

    // Add a sharper flame “front edge” shimmer band
    ctx.globalCompositeOperation = "lighter";
    const bandY = h - 18;
    const grad = ctx.createLinearGradient(0, bandY - 30, 0, bandY + 30);
    grad.addColorStop(0, "rgba(0,0,0,0)");
    grad.addColorStop(0.45, "rgba(255,110,15,0.10)");
    grad.addColorStop(0.75, "rgba(255,170,70,0.12)");
    grad.addColorStop(1, "rgba(0,0,0,0)");
    ctx.fillStyle = grad;
    ctx.fillRect(0, bandY - 40, w, 90);

    t++;
    requestAnimationFrame(step);
  }

  // Prime the canvas with true black first (no trail ghosting at load)
  ctx.globalCompositeOperation = "source-over";
  ctx.fillStyle = "#000";
  ctx.fillRect(0, 0, canvas.clientWidth, canvas.clientHeight);

  step();
})();
</script>
</body>
</html>
